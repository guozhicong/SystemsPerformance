## perftest 工具使用

> [!NOTE]
>
> 【TODO 仔细看清工具作用后补充完整】网络时延带宽测试工具，具体请见[github: linux-rdma/perftest](https://github.com/linux-rdma/perftest)
>
> 920B新机型相对920的网络时延会更大，带宽也更大。未来的机型会向更大的带宽发展，但是时延会有所增加，所以新机型在低时延场景下存在风险。

### 安装

```shell
yum install perftest
```

### 测试

> [!CAUTION]
>
>   920B 机型性能模式未开启的情况下，t_avg[usec]可能出现波动的情况。 920理论上也有这个情况，未测试。



```shell
# 服务端
[root@hostname-xrd2k hack]# ib_send_lat

************************************
* Waiting for client to connect... *
************************************

# 客户端
[root@hostname-xrd2k ~]# ib_send_lat 192.11.22.3
---------------------------------------------------------------------------------------
                    Send Latency Test
 Dual-port       : OFF          Device         : hns_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 1
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 4
 Max inline data : 0[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x000a PSN 0x2b7eea
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:175:11:22:03
 remote address: LID 0000 QPN 0x000b PSN 0x2fef47
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:175:11:22:03
---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] 
 2       1000          1.01           3.41         1.08                1.09             0.08            1.27                    3.41   
---------------------------------------------------------------------------------------
```

